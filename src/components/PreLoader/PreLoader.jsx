import cls from './PreLoader.module.css'
import { useState, useEffect } from 'react';
import { useMediaQuery } from 'react-responsive';


export const PreLoader = ({onLoadComplete, isLoaded}) =>{

    const isMobile = useMediaQuery({ query: "(max-width: 960px)" });  
    const [progress, setProgress] = useState(0);
    const [loaded, setLoaded] = useState(true);


    useEffect(() => {
      const interval = setInterval(() => {
        setProgress((oldProgress) => {
          const newProgress = Math.min(oldProgress + 1, 100);
          if (newProgress >= 100) {
            clearInterval(interval);
          }
          return newProgress;
        });
      }, 50);
      const timer = setTimeout(() => {
        onLoadComplete(); // вызываем колбэк, когда "загрузка" завершена
      }, 5500); // например, 2 секунды
  
      return () => {clearInterval(interval);clearTimeout(timer);};

    }, [onLoadComplete]);


    return(
        <div
            className={`${cls.preLoaderWrapper} ${isLoaded ? cls.hideLoader: "" }`}
        >
            <div className={cls.preLoaderContent}>
                <div className={cls.top}>
                    <div className={cls.left}>
                        <p>載入中</p>
                    </div>
                    <div className={cls.line}>
                        <span></span>
                        <span
                            style={{
                                width: `${progress}%`,
                                background: `#1D1D1B`
                            }}
                        ></span>
                    </div>
                    <div className={cls.right}>
                        <p>تحميل</p>
                    </div>
                </div>
                <div className={cls.middle}>
                    <div className={cls.left}>
                        <p>Жүктелуде</p>
                    </div>
                    <div className={cls.mainLogo}>
                        <svg xmlns="http://www.w3.org/2000/svg" width="48" height="43" viewBox="0 0 48 43" fill="none">
                            <path d="M12.6953 41.6L0.695312 21.1L12.6953 0.600006M12.6953 41.6H35.6953L47.1953 21.1M12.6953 41.6L23.1953 21.1M12.6953 0.600006H35.6953L47.1953 21.1M12.6953 0.600006L23.1953 21.1M47.1953 21.1H23.1953" stroke="#1D1D1B" strokeWidth="1.2"/>
                        </svg>
                        <svg xmlns="http://www.w3.org/2000/svg" width="97" height="44" viewBox="0 0 97 44" fill="none">
                            <path flipRule="evenodd" clipRule="evenodd" d="M17.6909 25.4171H4.42256V12.6996H13.25V11.5114H4.42256V1.17027H17.6909V6.3244e-05H0.000208537V26.6053H17.6909V25.4171Z" fill="#1D1D1B"/>
                            <path flipRule="evenodd" clipRule="evenodd" d="M27.1565 13.9064V1.1702H32.1159C33.8675 1.1702 35.3636 1.79191 36.6036 3.03603C37.8429 4.27946 38.4633 5.78057 38.4633 7.53795C38.4633 9.28359 37.8429 10.7812 36.6036 12.0309C35.3636 13.2812 33.8675 13.9064 32.1159 13.9064H27.1565ZM39.1291 14.0549C40.2645 13.3745 41.1705 12.4647 41.8494 11.3256C42.5276 10.1871 42.8677 8.92437 42.8677 7.53795C42.8677 6.15222 42.5276 4.88945 41.8494 3.75033C41.1705 2.6119 40.2645 1.70212 39.1291 1.02169C37.9944 0.340564 36.7358 0 35.354 0H22.7342V26.6052H27.1565V15.0759H29.8768L38.2409 26.6052H43.7187L35.354 15.0759C36.7358 15.0759 37.9944 14.7353 39.1291 14.0549Z" fill="#1D1D1B"/>
                            <path flipRule="evenodd" clipRule="evenodd" d="M66.2472 17.8794C65.79 19.3404 65.1146 20.6336 64.2209 21.7596C63.3258 22.8863 62.2186 23.7774 60.8988 24.4336C59.5789 25.0899 58.0559 25.4173 56.3284 25.4173H51.8682V1.16978H56.3284C58.5489 1.16978 60.4485 1.7176 62.0279 2.8132C63.6067 3.90811 64.8192 5.37258 65.664 7.20388C66.5088 9.03586 66.9316 11.0654 66.9316 13.2939C66.9316 14.8903 66.703 16.4191 66.2472 17.8794ZM69.5597 6.61876C68.3623 4.60786 66.7622 3.00177 64.7572 1.80117C62.7522 0.60057 60.5284 0.000274058 58.0862 0.000274058H47.4459V26.6055H58.0862C60.5284 26.6055 62.7522 26.0052 64.7572 24.8046C66.7622 23.604 68.3623 21.9986 69.5597 19.987C70.7556 17.9754 71.3546 15.7511 71.3546 13.3119C71.3546 10.8616 70.7556 8.63105 69.5597 6.61876Z" fill="#1D1D1B"/>
                            <path flipRule="evenodd" clipRule="evenodd" d="M81.6248 5.25453L86.7322 16.2644H76.5174L81.6248 5.25453ZM75.9624 17.4339H87.2878L91.5435 26.6056H96.4285L84.0676 0.000358383H82.7726L70.411 26.6056H71.7061L75.9624 17.4339Z" fill="#1D1D1B"/>
                            <path flipRule="evenodd" clipRule="evenodd" d="M7.13095 38.1622H1.78327V33.0359H0V43.7604H1.78327V38.6341H7.13095V43.7604H8.91354V33.0359H7.13095V38.1622Z" fill="#1D1D1B"/>
                            <path flipRule="evenodd" clipRule="evenodd" d="M24.5117 40.097C24.3699 40.6635 24.1496 41.1933 23.8514 41.6872C23.6029 42.0969 23.2958 42.4581 22.9302 42.7725C22.5646 43.0868 22.1487 43.3092 21.6805 43.4384C21.4519 43.4985 21.2185 43.5282 20.9796 43.5282C20.7462 43.5282 20.5121 43.4985 20.2787 43.4384C19.8112 43.3092 19.3946 43.0868 19.029 42.7725C18.6634 42.4581 18.3564 42.0969 18.1078 41.6872C17.8097 41.1933 17.5901 40.6635 17.4475 40.097C17.3057 39.5306 17.2355 38.9627 17.2355 38.3942C17.2355 37.8257 17.3057 37.2585 17.4475 36.6921C17.5901 36.1256 17.8097 35.5951 18.1078 35.1012C18.3564 34.6922 18.6634 34.3303 19.029 34.0167C19.3946 33.7017 19.8112 33.4799 20.2787 33.35C20.5121 33.2906 20.7462 33.2602 20.9796 33.2602C21.2185 33.2602 21.4519 33.2906 21.6805 33.35C22.1487 33.4799 22.5646 33.7017 22.9302 34.0167C23.2958 34.3303 23.6029 34.6922 23.8514 35.1012C24.1496 35.5951 24.3699 36.1256 24.5117 36.6921C24.6535 37.2585 24.7238 37.8257 24.7238 38.3942C24.7238 38.9627 24.6535 39.5306 24.5117 40.097ZM25.4921 35.0826C25.1492 34.6163 24.7451 34.2121 24.2803 33.8702C23.8149 33.5289 23.3034 33.263 22.7436 33.0737C22.1845 32.8837 21.5965 32.7891 20.9796 32.7891C20.3634 32.7891 19.7747 32.8837 19.2156 33.0737C18.6559 33.263 18.1436 33.5289 17.6789 33.8702C17.2141 34.2121 16.8113 34.6163 16.4705 35.0826C16.1297 35.5495 15.8653 36.0635 15.676 36.6244C15.4873 37.186 15.393 37.7759 15.393 38.3942C15.393 39.0131 15.4873 39.6031 15.676 40.164C15.8653 40.7256 16.1297 41.2396 16.4705 41.7066C16.8113 42.1728 17.2141 42.5784 17.6789 42.9224C18.1436 43.2664 18.6559 43.5323 19.2156 43.7188C19.7747 43.9067 20.3634 44 20.9796 44C21.5965 44 22.1845 43.9067 22.7436 43.7188C23.3034 43.5323 23.8149 43.2664 24.2803 42.9224C24.7451 42.5784 25.1492 42.1728 25.4921 41.7066C25.8357 41.2396 26.1015 40.7256 26.2908 40.164C26.4795 39.6031 26.5738 39.0131 26.5738 38.3942C26.5738 37.7759 26.4795 37.186 26.2908 36.6244C26.1015 36.0635 25.8357 35.5495 25.4921 35.0826Z" fill="#1D1D1B"/>
                            <path flipRule="evenodd" clipRule="evenodd" d="M34.836 33.0361H33.0534V43.7599H40.1843V43.2812H34.836V33.0361Z" fill="#1D1D1B"/>
                            <path flipRule="evenodd" clipRule="evenodd" d="M54.2416 40.243C54.0578 40.8316 53.7851 41.3532 53.425 41.807C53.0642 42.2609 52.6181 42.6201 52.0866 42.8847C51.5537 43.1492 50.9395 43.2812 50.2434 43.2812H48.4457V33.5071H50.2434C51.1385 33.5071 51.9041 33.7282 52.541 34.1696C53.1772 34.611 53.666 35.2016 54.0068 35.9394C54.3469 36.6779 54.5177 37.4965 54.5177 38.3945C54.5177 39.0383 54.4255 39.6545 54.2416 40.243ZM53.6412 33.7613C52.8329 33.2778 51.9364 33.036 50.9519 33.036H46.6632V43.7599H50.9519C51.9364 43.7599 52.8329 43.5188 53.6412 43.0345C54.4495 42.551 55.0947 41.903 55.5766 41.092C56.0593 40.2817 56.3003 39.3851 56.3003 38.4014C56.3003 37.4135 56.0593 36.5148 55.5766 35.7038C55.0947 34.8928 54.4495 34.2456 53.6412 33.7613Z" fill="#1D1D1B"/>
                            <path flipRule="evenodd" clipRule="evenodd" d="M62.7792 43.7602H64.5619V33.0357H62.7792V43.7602Z" fill="#1D1D1B"/>
                            <path flipRule="evenodd" clipRule="evenodd" d="M79.7832 41.2756L71.5637 33.0358H71.0411V43.7604H71.519V35.513L79.7309 43.7604H80.2527V33.0358H79.7832V41.2756Z" fill="#1D1D1B"/>
                            <path flipRule="evenodd" clipRule="evenodd" d="M91.9387 38.6263H94.7059V43.035H94.699C94.3203 43.2836 93.9079 43.4384 93.4604 43.4985C93.3014 43.5185 93.1395 43.5282 92.9756 43.5282H92.8785C92.4854 43.5033 92.1054 43.4211 91.7377 43.2816C91.1456 43.0474 90.623 42.7048 90.1706 42.2558C89.6487 41.7425 89.2536 41.1512 88.9851 40.4825C88.7165 39.8138 88.5822 39.1182 88.5822 38.3949C88.5822 37.8809 88.6476 37.3753 88.7798 36.8786C88.9113 36.3826 89.1145 35.9122 89.3878 35.4687C89.6309 35.0639 89.9269 34.704 90.2753 34.3869C90.623 34.0698 91.0162 33.8142 91.454 33.6194C91.9759 33.3853 92.5206 33.2678 93.0872 33.2678C93.689 33.2678 94.257 33.3935 94.792 33.6457C95.3263 33.8978 95.7972 34.246 96.2055 34.6895L96.5484 34.3455C95.9914 33.8363 95.3683 33.4502 94.6798 33.1856C93.9913 32.9211 93.2738 32.7891 92.5274 32.7891C91.5931 32.7891 90.707 32.9977 89.8691 33.4143C89.0305 33.8301 88.331 34.4256 87.7691 35.1986C87.0779 36.1768 86.7322 37.242 86.7322 38.3949C86.7322 39.5471 87.0779 40.6123 87.7691 41.5898C88.331 42.3635 89.0305 42.9583 89.8691 43.3748C90.707 43.7914 91.5931 44 92.5274 44C93.2738 44 93.9926 43.866 94.6839 43.5993C95.3752 43.3327 95.9969 42.9445 96.5484 42.436V38.1552H91.9387V38.6263Z" fill="#1D1D1B"/>
                        </svg>
                    </div>
                    <div className={cls.right}>
                        <p>Загрузка</p>
                    </div>
                </div>
                <div className={cls.bottom}>
                    {isMobile&& 
                    <div className={cls.mobileLoadingText}>
                        <p 
                            style={
                                {
                                    transform: progress > 15? "translateY(30px)": ""
                                }
                            }
                        >Жүктелуде</p>
                        <p
                            style={
                                {
                                    transform: (progress > 15 && progress< 30)? "translateY(0)":progress> 30? "translateY(30px)":""
                                }
                            }
                        >Loading</p>
                        <p
                            style={
                                {
                                    transform: (progress > 30 && progress< 80)? "translateY(0)":progress> 80? "translateY(30px)":""
                                }
                            }
                        >Загрузка</p>
                        <p
                            style={
                                {
                                    transform: (progress > 80 && progress< 100)? "translateY(0)":progress> 100? "none":""
                                }
                            }
                        >Yükleniyor</p>
                    </div>}
                    <div className={cls.left}>
                        <p>Loading</p>
                    </div>
                    <div className={cls.progress}>
                        <p className={cls.progressValue}>{progress}%</p>
                    </div>
                    <div className={cls.right}>
                        <p>Yükleniyor</p>
                    </div>
                </div>
            </div>

        </div>
    )
}